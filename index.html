<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WCAG 2.1 — 1.4.3 Contrast (Minimum): PASS (sx) vs FAIL (dx)</title>
<style>
  :root{
    --ok:#11623d;       /* PASS badge: #fff su --ok = 7.40:1 (AAA) */
    --bad:#a52834;      /* FAIL badge: #fff su --bad = 7.11:1 (AAA) */
    --ink:#222;
    --page:#fafafa;
    --muted:#111;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--ink);background:var(--page);line-height:1.5}
  p{line-height:1.5}
  .wrap{max-width:1000px;margin:0 auto;padding:24px 16px 64px}
  header h1{margin:0 0 6px 0;font-size:1.6rem}
  header p{margin:0}
  .legend{margin-top:12px;font-size:.95rem}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:20px}
  .row{display:contents}
  .example{background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:14px;display:flex;flex-direction:column;gap:10px}
  .example h3{margin:0;font-size:1.05rem;display:flex;justify-content:space-between;align-items:center;gap:8px}
  .badge{font-size:.8rem;padding:3px 8px;border-radius:999px;color:#fff}
  .pass .badge{background:var(--ok)}
  .fail .badge{background:var(--bad)}
  .demo{border-radius:8px;min-height:84px;display:grid;place-items:center;text-align:center;padding:12px;position:relative;overflow:hidden}
  .note{font-size:.9rem;color:var(--muted);margin:0}
  .kbd{font-family:ui-monospace,Menlo,Consolas,monospace;background:#f3f4f6;border:1px solid #e5e7eb;padding:1px 6px;border-radius:6px}
  .equal{font-size:24px;font-weight:700;letter-spacing:.2px}

  /* Accessibilità: testo solo-per-screen-reader */
  .sr-only{
    position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0
  }

  /* Pair 1 */
  .p1-pass{background:#0b3d5c;color:#ffffff;font-size:18px}
  .p1-fail{background:#0b3d5c;color:#7ca2cc;font-size:18px}

  /* Pair 2 */
  .p2-pass{background:#ffffff;color:#222;border:1px solid #e5e7eb}
  .p2-fail{background:#ffffff;color:#9a9a9a;border:1px dashed #e5e7eb}

  /* Pair 3 (AAA per “large text”) */
  .p3-pass{background:#ffffff;color:#757575;font-size:28px;font-weight:400} /* 4.5:1 */
  .p3-fail{background:#ffffff;color:#8a8a8a;font-size:16px;font-weight:400}

  /* Testo su immagine (24px bold uniforme) */
  .imgbox .content,.moving-bg .content,.trap-container .content,.trap-dark .content,.p8-pass .text,.p8-fail .text,.p10-fail .content{font-size:24px;font-weight:700;letter-spacing:.2px}
  .imgbox{background:#333;color:#fff;min-height:160px}
  .imgbox .bg{position:absolute;inset:0;background:url('my_hero.jpg') center/cover no-repeat}
  .imgbox.overlay::before{content:"";position:absolute;inset:0;background:linear-gradient(0deg,rgba(0,0,0,.72),rgba(0,0,0,.58))}
  .imgbox .content{position:relative;z-index:2;padding:8px 12px;border-radius:10px;background:rgba(0,0,0,.52);text-shadow:0 1px 2px rgba(0,0,0,.45)}

  /* Moving background */
  @keyframes pan{from{background-position:0% 50%}to{background-position:100% 50%}}
  .moving-bg{position:relative;min-height:140px;color:#fff}
  .moving-bg::before{content:"";position:absolute;inset:0;background:url('my_hero.jpg') center/160% no-repeat;animation:pan 8s linear infinite}
  .moving-bg .content{position:relative;z-index:1;padding:10px}
  .p4b-pass.moving-bg::after{content:"";position:absolute;inset:0;background:rgba(0,0,0,.55)}

  /* Canvas */
  canvas.p5-fail{width:100%;height:160px;display:block;border-radius:8px}

  /* TRAP DOM bianco */
  .trap-container{position:relative;background:#ffffff;color:#ffffff;min-height:140px;border:1px solid #e5e7eb}
  .trap-container img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
  .trap-container .content{position:relative;z-index:1;padding:10px}

  /* TRAP DOM nero */
  .trap-dark{position:relative;background:#000;color:#fff;min-height:140px;border:1px solid #111}
  .trap-dark img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
  .trap-dark .content{position:relative;z-index:1;padding:10px;text-shadow:0 1px 2px rgba(0,0,0,.45)}

  /* Gradiente */
  .p7-fail{background:linear-gradient(90deg,#fdfdfd 0%,#efefef 45%,#cfe8ff 55%,#a8d1ff 100%);color:#8a8a8a;font-size:18px}
  .p7-pass{background:#a8d1ff;color:#222;font-size:18px}

  /* Foto con testo separato / fuso */
  .blend-bg{position:relative;min-height:140px}
  .blend-bg::before{content:"";position:absolute;inset:0;background:url('my_hero.jpg') center/cover no-repeat}
  .p8-pass.blend-bg::after{content:"";position:absolute;inset:0;background:rgba(0,0,0,.58)}
  .p8-pass .text{position:relative;z-index:1;color:#fff;padding:6px 10px;border-radius:10px;background:rgba(0,0,0,.52);text-shadow:0 1px 2px rgba(0,0,0,.45)}
  .p8-fail .text{position:relative;z-index:1;color:#fff;mix-blend-mode:difference;padding:10px}

  /* Pseudo-element TRAP */
  .p9-pass{background:#ddeeff;color:#222}
  .p9-fail{position:relative;background:#ffffff;color:#8a8a8a}
  .p9-fail::before{content:"";position:absolute;inset:0;background:radial-gradient(circle at 50% 50%,#ffffff 0 40%,#f2f6ff 40% 100%);z-index:0}
  .p9-fail .content{position:relative;z-index:1;font-size:20px}

  /* Overlay sopra il testo TRAP */
  .p10-pass{background:#0b3d5c;color:#fff;font-size:24px;font-weight:700}
  .p10-fail{position:relative;background:#0b3d5c;color:#fff}
  .p10-fail .content{position:relative;z-index:1;padding:10px}
  .p10-fail::after{content:"";position:absolute;inset:0;background:rgba(255,255,255,.5);z-index:3;pointer-events:none}

  /* Background-clip:text */
  .p11-pass{background:#ffffff;color:#111;border:1px solid #e5e7eb}
  .clip-wrap{background:#ffffff;border:1px dashed #e5e7eb}
  .clip-text{font-size:44px;font-weight:800;line-height:1.1;margin:8px 0;background:url('my_hero.jpg') center/cover no-repeat;-webkit-background-clip:text;background-clip:text;color:transparent}

  /* Opacity TRAP */
  .p12-pass{background:#ffffff;color:#222;border:1px solid #e5e7eb}
  .p12-fail{background:#ffffff;border:1px dashed #e5e7eb}
  .p12-fail .text{color:#222;opacity:.45}

  /* Link */
  .link-pass{background:#fff;color:#222}
  .link-pass a{color:#0645ad;text-decoration:underline} /* ~8.5:1 (AAA) */
  .link-fail{background:#fff;color:#222}
  .link-fail a{color:#7aa7ff;text-decoration:none}
  .link-fail .trap{position:relative;display:inline-block;padding:6px 8px}
  .link-fail .trap::after{content:"";position:absolute;inset:-4px;outline:2px dotted #7aa7ff;border-radius:8px;pointer-events:none}

  /* Button */
  .btn{display:inline-block;padding:10px 14px;border-radius:10px;font-weight:600}
  .p14-pass .btn{background:#0052a3;color:#ffffff;border:2px solid #003a73} /* 7.68:1 (AAA) */
  .p14-fail .btn{background:#0066cc;color:#7ab3e0;border:2px solid #66a9e6}
  .p14-fail .btn.trap{position:relative}
  .p14-fail .btn.trap::before{content:"";position:absolute;inset:0;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,.45),transparent)}

  /* Placeholder */
  .input-demo{background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:12px}
  .input-demo input{width:100%;padding:12px 10px;border-radius:8px;font-size:16px;border:1px solid #cbd5e1;color:#111;background:#fff}
  .input-pass input::placeholder{color:#555;opacity:1}  /* ~7.46:1 (AAA) */
  .input-fail input::placeholder{color:#bdbdbd;opacity:1}
  .input-fail .trap{position:relative}
  .input-fail .trap::after{content:"";position:absolute;inset:6px;border-radius:6px;background:rgba(255,255,255,.35);pointer-events:none}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>WCAG 2.1 — 1.4.3 “Contrast (Minimum)”</h1>
      <p>Griglia con coppie <strong>PASS</strong> (sinistra) vs <strong>FAIL</strong> (destra). Livello AA: <span class="kbd">≥4.5:1</span> testo normale; <span class="kbd">≥3:1</span> “large text”.</p>
      <p class="legend">“Large text” = <strong>≥24&nbsp;px regolare</strong> oppure <strong>≥19&nbsp;px grassetto</strong> (14&nbsp;pt ≈ 18.5
        &nbsp;px; 18&nbsp;pt ≈ 24&nbsp;px; 1&nbsp;pt = 1.333&nbsp;px).</p>
      <p class="legend">I casi “TRAP” mostrano situazioni dove i tool che leggono solo DOM/CSS possono sbagliare.</p>
    </header>

    <section class="grid" aria-label="Casi dimostrativi">
      <!-- Pair 1 -->
      <div class="row">
        <article class="example pass">
          <h3>Sfondo scuro uniforme, testo bianco <span class="badge">PASS</span></h3>
          <div class="demo p1-pass equal">#fff su #0b3d5c</div>
          <p class="note">Rapporto molto alto.</p>
        </article>
        <article class="example fail">
          <h3>Sfondo scuro uniforme, testo azzurro chiaro <span class="badge">FAIL</span></h3>
          <div class="demo p1-fail equal">#7ca2cc su #0b3d5c</div>
          <p class="note">Insufficiente per 4.5:1.</p>
        </article>
      </div>

      <!-- Pair 2 -->
      <div class="row">
        <article class="example pass">
          <h3>Sfondo uniforme chiaro, testo scuro <span class="badge">PASS</span></h3>
          <div class="demo p2-pass equal">#222 su #fff</div>
          <p class="note">Molto oltre la soglia.</p>
        </article>
        <article class="example fail">
          <h3>Sfondo uniforme chiaro, testo grigio tenue <span class="badge">FAIL</span></h3>
          <div class="demo p2-fail equal">#9a9a9a su #fff</div>
          <p class="note">Contrasto troppo basso.</p>
        </article>
      </div>

      <!-- Pair 3 -->
      <div class="row">
        <article class="example pass">
          <h3>Sfondo uniforme chiaro, testo “grande” <span class="badge">PASS</span></h3>
          <div class="demo p3-pass">28&nbsp;px, #757575 su #fff</div>
          <p class="note">Testo grande conforme.</p>
        </article>
        <article class="example fail">
          <h3>Sfondo uniforme chiaro, testo normale <span class="badge">FAIL</span></h3>
          <div class="demo p3-fail">16&nbsp;px, #8a8a8a su #fff</div>
          <p class="note">Non raggiunge 4.5:1.</p>
        </article>
      </div>

      <!-- Pair 4 -->
      <div class="row">
        <article class="example pass">
          <h3>Foto con velo scuro (overlay) <span class="badge">PASS</span></h3>
          <figure class="demo imgbox overlay">
            <div class="bg" aria-hidden="true"></div>
            <div class="content">Testo leggibile sopra immagine</div>
            <figcaption class="sr-only">Testo leggibile su immagine grazie al velo scuro.</figcaption>
          </figure>
          <p class="note">Velo e riquadro scuri stabilizzano il contrasto.</p>
        </article>
        <article class="example fail">
          <h3>Foto senza velo <span class="badge">FAIL</span></h3>
          <figure class="demo imgbox">
            <div class="bg" aria-hidden="true"></div>
            <div class="content" style="background:none">Zone chiare → insufficiente</div>
            <figcaption class="sr-only">Testo su immagine senza velo: contrasto locale non garantito.</figcaption>
          </figure>
          <p class="note">Il contrasto locale non è garantito.</p>
        </article>
      </div>

      <!-- Pair 4b (TRAP didattica) -->
      <div class="row">
        <article class="example pass">
          <h3>TRAP: immagine in movimento con velo (::after) <span class="badge">PASS</span></h3>
          <div class="demo moving-bg p4b-pass"><div class="content">Sfondo animato stabilizzato</div></div>
          <p class="note">PASS reale; alcuni tool DOM-only marcano FAIL perché il velo è in uno pseudo-elemento.</p>
        </article>
        <article class="example fail">
          <h3>Immagine in movimento senza velo <span class="badge">FAIL</span></h3>
          <div class="demo moving-bg"><div class="content">Testo su texture mobile</div></div>
          <p class="note">Il testo entra in aree troppo chiare.</p>
        </article>
      </div>

      <!-- Pair 5 -->
      <div class="row">
        <article class="example pass">
          <h3>Sfondo uniforme dichiarato <span class="badge">PASS</span></h3>
          <div class="demo equal" style="background:#ffffff;border:1px solid #e5e7eb;color:#222">#222 su #fff</div>
          <p class="note">Caso semplice nel DOM.</p>
        </article>
        <article class="example fail">
          <h3>Testo dentro immagine (raster) <span class="badge">FAIL</span></h3>
          <canvas class="p5-fail" id="p5canvas" aria-label="Canvas con testo poco leggibile"></canvas>
          <p class="note">Non misurabile dal DOM.</p>
        </article>
      </div>

      <!-- Pair 6: DOM vs reale -->
      <div class="row">
        <article class="example pass">
          <h3>Sfondo uniforme dichiarato <span class="badge">PASS</span></h3>
          <div class="demo equal" style="background:#ffffff;color:#222;border:1px solid #e5e7eb;">#222 su #fff</div>
          <p class="note">Nessuna sorpresa.</p>
        </article>
        <article class="example fail">
          <h3>TRAP: sfondo reale è un’immagine <span class="badge">FAIL</span></h3>
          <div class="demo trap-container">
            <img src="my_hero.jpg" alt="" aria-hidden="true">
            <div class="content">Il DOM dice #fff, ma sotto c’è un’immagine.</div>
          </div>
          <p class="note">Falso PASS se si misura solo il DOM.</p>
        </article>
      </div>

      <!-- Pair 6b -->
      <div class="row">
        <article class="example pass">
          <h3>Sfondo reale nero uniforme, testo bianco <span class="badge">PASS</span></h3>
          <div class="demo equal" style="background:#000;color:#fff;border:1px solid #111">#fff su #000</div>
          <p class="note">Contrasto massimo.</p>
        </article>
        <article class="example fail">
          <h3>TRAP: DOM dice nero, sotto è un’immagine <span class="badge">FAIL</span></h3>
          <div class="demo trap-dark">
            <img src="my_hero.jpg" alt="" aria-hidden="true">
            <div class="content">Il DOM dice #000, ma sotto c’è un’immagine.</div>
          </div>
          <p class="note">Il testo cade su zone chiare.</p>
        </article>
      </div>

      <!-- Pair 7 -->
      <div class="row">
        <article class="example pass">
          <h3>Sfondo uniforme azzurro, testo scuro <span class="badge">PASS</span></h3>
          <div class="demo p7-pass equal">Contrasto stabile</div>
          <p class="note">Colore uniforme.</p>
        </article>
        <article class="example fail">
          <h3>Sfondo a gradiente, testo grigio <span class="badge">FAIL</span></h3>
          <div class="demo p7-fail equal">Porzioni molto chiare → rischio</div>
          <p class="note">In alcune zone è troppo chiaro.</p>
        </article>
      </div>

      <!-- Pair 8 -->
      <div class="row">
        <article class="example pass p8-pass">
          <h3>Foto con velo scuro (testo separato) <span class="badge">PASS</span></h3>
          <div class="demo blend-bg"><div class="text">Testo normale con velo</div></div>
          <p class="note">Il velo garantisce il contrasto.</p>
        </article>
        <article class="example fail p8-fail">
          <h3>Foto con testo che si mescola allo sfondo <span class="badge">FAIL</span></h3>
          <div class="demo blend-bg"><div class="text">Colore dipende dallo sfondo</div></div>
          <p class="note">Il colore dipende dallo sfondo. Contrasto imprevedibile.</p>
        </article>
      </div>

      <!-- Pair 9 -->
      <div class="row">
        <article class="example pass">
          <h3>Sfondo uniforme (blu chiaro dichiarato) <span class="badge">PASS</span></h3>
          <div class="demo p9-pass equal">Testo #222 su blu chiaro</div>
          <p class="note">Fondo dichiarato = misurato.</p>
        </article>
        <article class="example fail">
          <h3>TRAP: sfondo aggiunto con ::before <span class="badge">FAIL</span></h3>
          <div class="demo p9-fail"><div class="content" style="font-size:20px">Zona centrale molto chiara</div></div>
          <p class="note">Lo sfondo reale non è nel bg del nodo.</p>
        </article>
      </div>

      <!-- Pair 10 -->
      <div class="row">
        <article class="example pass">
          <h3>Sfondo scuro uniforme, testo in primo piano <span class="badge">PASS</span></h3>
          <div class="demo p10-pass">#fff su #0b3d5c, nessun velo sopra</div>
          <p class="note">Valori reali = DOM.</p>
        </article>
        <article class="example fail">
          <h3>TRAP: sfondo scuro, testo con velo chiaro sopra <span class="badge">FAIL</span></h3>
          <div class="demo p10-fail"><div class="content">Il velo schiarisce il testo</div></div>
          <p class="note">Contrasto reale ridotto.</p>
        </article>
      </div>

      <!-- Pair 11 -->
      <div class="row">
        <article class="example pass">
          <h3>Testo pieno ad alto contrasto <span class="badge">PASS</span></h3>
          <div class="demo p11-pass equal" style="font-weight:800">TESTO SOLIDO</div>
          <p class="note">Colore dichiarato e misurabile.</p>
        </article>
        <article class="example fail">
          <h3>Testo riempito con immagine <span class="badge">FAIL</span></h3>
          <div class="demo clip-wrap"><div class="clip-text">IMMAGINE</div></div>
          <p class="note">Il colore dipende dai pixel.</p>
        </article>
      </div>

      <!-- Pair 12 -->
      <div class="row">
        <article class="example pass">
          <h3>Testo opaco (100%) su #fff <span class="badge">PASS</span></h3>
          <div class="demo p12-pass equal"><div class="text">#222 su #fff (opaco)</div></div>
          <p class="note">Rapporto stabile.</p>
        </article>
        <article class="example fail">
          <h3>Testo semitrasparente su #fff <span class="badge">FAIL</span></h3>
          <div class="demo p12-fail equal"><div class="text">#222 con opacity .45</div></div>
          <p class="note">La trasparenza abbassa il contrasto.</p>
        </article>
      </div>

      <!-- Pair 13 -->
      <div class="row">
        <article class="example pass">
          <h3>Link distinguibile (scuro + sottolineato) <span class="badge">PASS</span></h3>
          <div class="demo link-pass">
            Testo normale e <a href="#">link sottolineato</a> (colore #0645ad).
          </div>
          <p class="note">Contrasto + non solo colore.</p>
        </article>
        <article class="example fail">
          <h3>Link solo-colore, troppo chiaro <span class="badge">FAIL</span></h3>
          <div class="demo link-fail">
            <span class="trap">Questo è un <a href="#">link</a> non sottolineato.</span>
          </div>
          <p class="note">Contrasto insufficiente.</p>
        </article>
      </div>

      <!-- Pair 14 -->
      <div class="row">
        <article class="example pass p14-pass">
          <h3>Button con label leggibile <span class="badge">PASS</span></h3>
          <div class="demo"><a class="btn" href="#">Scarica</a></div>
          <p class="note">La label rispetta 1.4.3 e 1.4.6 (AAA).</p>
        </article>
        <article class="example fail p14-fail">
          <h3>Button con label schiarita <span class="badge">FAIL</span></h3>
          <div class="demo"><a class="btn trap" href="#">Scarica</a></div>
          <p class="note">Il gradiente schiarisce la label.</p>
        </article>
      </div>

      <!-- Pair 15 -->
      <div class="row">
        <article class="example pass">
          <h3>Placeholder leggibile <span class="badge">PASS</span></h3>
          <div class="demo input-demo input-pass"><input placeholder="Cerca documenti…"></div>
          <p class="note">È testo e deve essere leggibile.</p>
        </article>
        <article class="example fail">
          <h3>Placeholder grigio tenue <span class="badge">FAIL</span></h3>
          <div class="demo input-demo input-fail"><div class="trap"><input placeholder="Cerca documenti…"></div></div>
          <p class="note">#bdbdbd su #fff non arriva a 4.5:1.</p>
        </article>
      </div>
    </section>

    <footer style="margin-top:28px;font-size:.9rem;color:#111">
      <p><strong>Nota 1.4.3:</strong> riguarda <em>testo e immagini di testo</em>. I loghi sono esclusi.</p>
    </footer>
  </div>

<script>
/* Pair 5: canvas — testo raster su porzione chiara dell’immagine (non “visibile” al DOM) */
(function(){
  const c = document.getElementById('p5canvas');
  const ctx = c.getContext('2d');
  const ratio = window.devicePixelRatio || 1;
  const W = c.width = c.clientWidth * ratio;
  const H = c.height = c.clientHeight * ratio;
  const img = new Image();
  img.src = 'my_hero.jpg';
  img.onload = () => {
    const iw = img.width, ih = img.height;
    const sx = Math.floor(iw * 0.55), sy = Math.floor(ih * 0.05);
    const sw = Math.floor(iw * 0.42), sh = Math.floor(ih * 0.5);
    ctx.drawImage(img, sx, sy, sw, sh, 0, 0, W, H);
    ctx.font = Math.floor(24*ratio) + 'px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
    ctx.fillStyle = '#8a8a8a';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('Testo dentro immagine (raster)', W/2, H/2);
  };
})();
</script>
</body>
</html>
