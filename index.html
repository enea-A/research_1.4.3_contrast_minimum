<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WCAG 2.1 — 1.4.3 Contrasto (Minimo): Esempi PASS vs FAIL</title>
<style>
  /* Variabili globali per colori e tipografia */
  :root {
    --ok: #11623d;
    --bad: #a52834;
    --ink: #222;
    --page: #fafafa;
    --muted: #000;
    --border: #e5e7eb;
    --heading-color: #333;
    --note-color: #000;
    --heading-font-size: 1.2rem;
    --note-font-size: 0.95rem;
  }

  /* Stili di base e reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    color: var(--ink);
    background: var(--page);
    line-height: 1.5;
  }

  /* Layout principale e intestazione */
  .wrap {
    max-width: 1000px;
    margin: 0 auto;
    padding: 24px 16px 64px;
  }
  header h1 {
    margin: 0 0 6px 0;
    font-size: 1.6rem;
  }
  header p {
    margin: 0;
  }
  .legend {
    margin-top: 14px;
    font-size: .95rem;
    color: var(--muted);
  }
  .kbd {
    font-family: ui-monospace, Menlo, Consolas, monospace;
    background: #f3f4f6;
    border: 1px solid var(--border);
    padding: 1px 6px;
    border-radius: 6px;
  }

  /* Stili per la griglia e gli esempi */
  .grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-top: 20px;
  }
  .row {
    display: contents;
  }
  .example {
    background: #fff;
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .example h3 {
    margin: 0;
    font-size: var(--heading-font-size);
    color: var(--heading-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
  }
  .badge {
    font-size: .8rem;
    padding: 3px 8px;
    border-radius: 999px;
    color: #fff;
    font-weight: 600;
  }
  .pass .badge {
    background: var(--ok);
  }
  .fail .badge {
    background: var(--bad);
  }
  .demo {
    border-radius: 8px;
    min-height: 84px;
    display: grid;
    place-items: center;
    text-align: center;
    padding: 12px;
    position: relative;
    overflow: hidden;
  }
  .note {
    font-size: var(--note-font-size);
    color: var(--note-color);
    margin: 0;
    line-height: 1.4;
  }
  .equal {
    font-size: 24px;
    font-weight: 700;
    letter-spacing: .2px;
  }

  /* Esempi specifici */
  .p1-pass { background: #0b3d5c; color: #ffffff; font-size: 18px; }
  .p1-fail { background: #0b3d5c; color: #7ca2cc; font-size: 18px; }
  .p2-pass { background: #ffffff; color: #222; border: 1px solid var(--border); }
  .p2-fail { background: #ffffff; color: #9a9a9a; border: 1px dashed var(--border); }
  .p3-pass { background: #ffffff; color: #757575; font-size: 28px; font-weight: 400; }
  .p3-fail { background: #ffffff; color: #8a8a8a; font-size: 16px; font-weight: 400; }
  .imgbox .content, .moving-bg .content, .fail-container .content, .fail-dark .content, .p8-pass .text, .p8-fail .text, .p10-fail .content {
    font-size: 24px;
    font-weight: 700;
    letter-spacing: .2px;
  }
  .imgbox { background: #333; color: #fff; min-height: 160px; }
  .imgbox .bg { position: absolute; inset: 0; background: url('my_hero.jpg') center/cover no-repeat; }
  .imgbox.overlay::before { content: ""; position: absolute; inset: 0; background: rgba(0,0,0,.65); }
  .imgbox .content { position: relative; z-index: 2; padding: 8px 12px; border-radius: 10px; background: rgba(0,0,0,.52); text-shadow: 0 1px 2px rgba(0,0,0,.45); }
  @keyframes pan { from { background-position: 0% 50%; } to { background-position: 100% 50%; } }
  .moving-bg { position: relative; min-height: 140px; color: #fff; }
  .moving-bg::before { content: ""; position: absolute; inset: 0; background: url('my_hero.jpg') center/160% no-repeat; animation: pan 8s linear infinite; }
  .moving-bg .content { position: relative; z-index: 1; padding: 10px; }
  .p4b-pass.moving-bg::after { content: ""; position: absolute; inset: 0; background: rgba(0,0,0,.55); }
  canvas.p5-fail { width: 100%; height: 160px; display: block; border-radius: 8px; }
  .fail-container, .fail-dark { position: relative; min-height: 140px; }
  .fail-container { background: #ffffff; color: #ffffff; border: 1px solid var(--border); }
  .fail-dark { background: #000; color: #fff; border: 1px solid #111; }
  .fail-container .fake-img, .fail-dark .fake-img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; background: url('my_hero.jpg') center/cover; }
  .fail-container .content, .fail-dark .content { position: relative; z-index: 1; padding: 10px; }
  .p7-fail { background: linear-gradient(90deg, #fdfdfd 0%, #efefef 45%, #cfe8ff 55%, #a8d1ff 100%); color: #8a8a8a; font-size: 18px; }
  .p7-pass { background: #a8d1ff; color: #222; font-size: 18px; }
  .blend-bg { position: relative; min-height: 140px; }
  .blend-bg::before { content: ""; position: absolute; inset: 0; background: url('my_hero.jpg') center/cover no-repeat; }
  .p8-pass.blend-bg::after { content: ""; position: absolute; inset: 0; background: rgba(0,0,0,.58); }
  .p8-pass .text { position: relative; z-index: 1; color: #fff; padding: 6px 10px; border-radius: 10px; background: rgba(0,0,0,.52); text-shadow: 0 1px 2px rgba(0,0,0,.45); }
  .p8-fail .text { position: relative; z-index: 1; color: #fff; mix-blend-mode: difference; padding: 10px; }
  .p9-pass { background: #ddeeff; color: #222; }
  .p9-fail { position: relative; background: #ffffff; color: #8a8a8a; }
  .p9-fail::before { content: ""; position: absolute; inset: 0; background: radial-gradient(circle at 50% 50%, #ffffff 0 40%, #f2f6ff 40% 100%); z-index: 0; }
  .p9-fail .content { position: relative; z-index: 1; font-size: 20px; }
  .p10-pass { background: #0b3d5c; color: #fff; font-size: 24px; font-weight: 700; }
  .p10-fail { position: relative; background: #0b3d5c; color: #fff; }
  .p10-fail .content { position: relative; z-index: 1; padding: 10px; }
  .p10-fail::after { content: ""; position: absolute; inset: 0; background: rgba(255,255,255,.5); z-index: 3; pointer-events: none; }
  .p11-pass { background: #ffffff; color: #111; border: 1px solid var(--border); }
  .clip-wrap { background: #ffffff; border: 1px dashed var(--border); }
  .clip-text { font-size: 44px; font-weight: 800; line-height: 1.1; margin: 8px 0; background: url('my_hero.jpg') center/cover no-repeat; -webkit-background-clip: text; background-clip: text; color: transparent; }
  .p12-pass { background: #ffffff; color: #222; border: 1px solid var(--border); }
  .p12-fail { background: #ffffff; border: 1px dashed var(--border); }
  .p12-fail .text { color: #222; opacity: .45; }
  .link-pass { background: #fff; color: #222; }
  .link-pass a { color: #0645ad; text-decoration: underline; }
  .link-fail { background: #fff; color: #222; }
  .link-fail a { color: #7aa7ff; text-decoration: none; }
  .link-fail .link-trap { position: relative; display: inline-block; padding: 6px 8px; }
  .link-fail .link-trap::after { content: ""; position: absolute; inset: -4px; outline: 2px dotted #7aa7ff; border-radius: 8px; pointer-events: none; }
  .btn { display: inline-block; padding: 10px 14px; border-radius: 10px; font-weight: 600; text-decoration: none; }
  .p14-pass .btn { background: #0052a3; color: #ffffff; border: 2px solid #003a73; }
  .p14-fail .btn { background: #0066cc; color: #7ab3e0; border: 2px solid #66a9e6; }
  .p14-fail .btn-trap { position: relative; }
  .p14-fail .btn-trap::before { content: ""; position: absolute; inset: 0; border-radius: 10px; background: linear-gradient(180deg, rgba(255,255,255,.45), transparent); }
  .input-demo { background: #fff; border: 1px solid var(--border); border-radius: 10px; padding: 12px; }
  .input-demo input { width: 100%; padding: 12px 10px; border-radius: 8px; font-size: 16px; border: 1px solid #cbd5e1; color: #111; background: #fff; }
  .input-pass input::placeholder { color: #555; opacity: 1; }
  .input-fail input::placeholder { color: #bdbdbd; opacity: 1; }
  .input-fail .input-trap { position: relative; }
  .input-fail .input-trap::after { content: ""; position: absolute; inset: 6px; border-radius: 6px; background: rgba(255,255,255,.35); pointer-events: none; }
  .sr-only {
    position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden;
    clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0;
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>WCAG 2.1 — Criterio 1.4.3 "Contrasto (Minimo)"</h1>
      <p>
        Questa pagina mostra esempi pratici di conformità
        <span class="badge" style="background:var(--ok)">PASS</span>
        e non conformità 
        <span class="badge" style="background:var(--bad)">FAIL</span>.
      </p>
      <p class="legend">
        Per il livello <strong>AA</strong>, il rapporto di contrasto deve essere 
        almeno <span class="kbd">4.5:1</span> per il testo normale e 
        almeno <span class="kbd">3:1</span> per il testo grande.
      </p>
    </header>
    <section class="grid" aria-label="Esempi di contrasto visivo">
      <div class="row">
        <article class="example pass">
          <h3>1A — Testo bianco su sfondo scuro <span class="badge">PASS</span></h3>
          <div class="demo p1-pass equal">#fff su #0b3d5c</div>
          <p class="note">Il contrasto elevato tra bianco e blu scuro garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>1B — Testo azzurro su sfondo scuro <span class="badge">FAIL</span></h3>
          <div class="demo p1-fail equal">#7ca2cc su #0b3d5c</div>
          <p class="note">Il contrasto tra azzurro e blu scuro non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>2A — Testo scuro su sfondo bianco <span class="badge">PASS</span></h3>
          <div class="demo p2-pass equal">#222 su #fff</div>
          <p class="note">Il contrasto tra testo scuro e sfondo bianco garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>2B — Testo grigio chiaro su sfondo bianco <span class="badge">FAIL</span></h3>
          <div class="demo p2-fail equal">#9a9a9a su #fff</div>
          <p class="note">Il contrasto tra grigio chiaro e bianco non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>3A — Testo grande — necessario 3:1  <span class="badge">PASS</span></h3>
          <div class="demo p3-pass">28px, #757575 su #fff</div>
          <p class="note">Il testo di grandi dimensioni richiede una soglia di contrasto ridotta (3:1): in questo caso è rispettata e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>3B — Testo normale — necessario 4.5:1 <span class="badge">FAIL</span></h3>
          <div class="demo p3-fail">16px, #8a8a8a su #fff</div>
          <p class="note">Il testo di dimensioni normali richiede un contrasto maggiore (≥ 4.5:1): in questo caso non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>4A — Testo su immagine con overlay scuro <span class="badge">PASS</span></h3>
          <figure class="demo imgbox overlay">
            <div class="bg" aria-hidden="true"></div>
            <div class="content">Testo leggibile</div>
          </figure>
          <p class="note">
            Un overlay scuro applicato sopra l’immagine assicura un contrasto sufficiente e la leggibilità del testo in tutte le aree.
            Realizzato via CSS (<code>::before</code>) sul contenitore.
          </p>
        </article>
        <article class="example fail">
          <h3>4B — Testo su immagine senza overlay scuro <span class="badge">FAIL</span></h3>
          <figure class="demo imgbox">
            <div class="bg" aria-hidden="true"></div>
            <div class="content" style="background:none">Leggibilità variabile</div>
          </figure>
          <p class="note">Senza overlay, il contrasto dipende dalle zone dell’immagine: in molte aree non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>4C — Animazione con overlay scuro <span class="badge">PASS</span></h3>
          <div class="demo moving-bg p4b-pass"><div class="content">Testo sempre leggibile</div></div>
          <p class="note">L’overlay scuro mantiene costante il contrasto durante l’animazione e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>4D — Animazione senza overlay <span class="badge">FAIL</span></h3>
          <div class="demo moving-bg"><div class="content">Contrasto instabile</div></div>
          <p class="note">Senza overlay, l’animazione modifica continuamente lo sfondo: il contrasto in più punti non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>5A — Testo su sfondo uniforme <span class="badge">PASS</span></h3>
          <div class="demo equal" style="background:#fff;color:#222;border:1px solid var(--border)">Testo su #fff</div>
          <p class="note">Uno sfondo uniforme rende il contrasto stabile e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>5B — Testo su canvas <span class="badge">FAIL</span></h3>
          <canvas class="p5-fail" id="p5canvas" aria-label="Canvas con testo grigio su sfondo chiaro"></canvas>
          <p class="note">La maggior parte dei tool automatici tratta il contenuto del canvas come un’immagine, quindi il testo non viene riconosciuto e il contrasto non può essere calcolato. Solo strumenti basati su analisi visiva della pagina possono stimarne la leggibilità.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>6A — Sfondo bianco <span class="badge">PASS</span></h3>
          <div class="demo equal" style="background:#ffffff;color:#222;border:1px solid var(--border)">Testo su #fff</div>
          <p class="note">Il codice dichiara uno sfondo bianco e l’utente vede effettivamente il bianco: il contrasto è adeguato e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>6B — Sfondo bianco sottostante l’immagine <span class="badge">FAIL</span></h3>
          <div class="demo fail-container">
            <div class="fake-img" aria-hidden="true"></div>
            <div class="content">Testo su #fff</div>
          </div>
          <p class="note">Il codice dichiara uno sfondo bianco, ma in realtà è coperto da un’immagine: i tool che si basano sul codice lo interpretano come bianco, mentre per l’utente conta l’immagine visibile che, se non adatta, non garantisce un contrasto sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>6C — Sfondo nero <span class="badge">PASS</span></h3>
          <div class="demo equal" style="background:#000;color:#fff;border:1px solid #111">Testo su #000</div>
          <p class="note">Il codice dichiara uno sfondo nero e l’utente vede effettivamente il nero: il contrasto è adeguato e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>6D — Sfondo nero sottostante l’immagine <span class="badge">FAIL</span></h3>
          <div class="demo fail-dark">
            <div class="fake-img" aria-hidden="true"></div>
            <div class="content">Testo su #000</div>
          </div>
          <p class="note">Il codice dichiara uno sfondo nero, ma in realtà è coperto da un’immagine: i tool che si basano sul codice lo interpretano come nero, mentre per l’utente conta l’immagine visibile che, se non adatta, non garantisce un contrasto sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>7A — Sfondo uniforme <span class="badge">PASS</span></h3>
          <div class="demo p7-pass equal">Contrasto costante</div>
          <p class="note">Uno sfondo a colore uniforme assicura un contrasto stabile e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>7B — Sfondo a gradiente <span class="badge">FAIL</span></h3>
          <div class="demo p7-fail equal">Contrasto instabile</div>
          <p class="note">Un gradiente crea aree con luminosità diversa: in queste zone il contrasto non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass p8-pass">
          <h3>8A — Testo con overlay scuro <span class="badge">PASS</span></h3>
          <div class="demo blend-bg"><div class="text">Testo leggibile</div></div>
          <p class="note">
            Un overlay scuro applicato sopra l’immagine mantiene il contrasto costante e garantisce un contrasto sufficiente e la leggibilità del testo. 
            Realizzato via CSS (<code>::after</code>) sul contenitore.
          </p>          
        </article>
        <article class="example fail p8-fail">
          <h3>8B — Testo con blend mode <span class="badge">FAIL</span></h3>
          <div class="demo blend-bg"><div class="text">Colore imprevedibile</div></div>
          <p class="note"> Il blend mode rende il colore del testo dipendente dallo sfondo: il contrasto non è prevedibile e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>9A — Sfondo applicato direttamente <span class="badge">PASS</span></h3>
          <div class="demo p9-pass equal">Sfondo CSS diretto</div>
          <p class="note">Lo sfondo è applicato direttamente all’elemento con il testo: il contrasto è calcolato correttamente e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>9B — Sfondo nascosto in un pseudo-elemento <span class="badge">FAIL</span></h3>
          <div class="demo p9-fail"><div class="content">Sfondo da ::before</div></div>
          <p class="note">Lo sfondo è inserito in un pseudo-elemento (<code>::before</code>) invece che nell’elemento principale: alcuni tool automatici non lo rilevano correttamente, quindi il contrasto non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>10A — Testo senza overlay <span class="badge">PASS</span></h3>
          <div class="demo p10-pass">Colori puri</div>
          <p class="note">I colori dichiarati corrispondono a quelli visualizzati: il contrasto è corretto e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>10B — Testo con overlay semitrasparente <span class="badge">FAIL</span></h3>
          <div class="demo p10-fail"><div class="content">Testo con overlay</div></div>
          <p class="note"> Un overlay bianco semitrasparente applicato sopra l’intero contenitore riduce il contrasto effettivo tra testo e sfondo: non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>11A — Testo con colore uniforme <span class="badge">PASS</span></h3>
          <div class="demo p11-pass equal" style="font-weight:800">TESTO UNIFORME</div>
          <p class="note">Il colore pieno e costante su tutte le lettere garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>11B — Testo riempito con immagine <span class="badge">FAIL</span></h3>
          <div class="demo clip-wrap"><div class="clip-text">IMMAGINE</div></div>
          <p class="note">Il riempimento con immagine fa variare i colori delle lettere: il contrasto non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>12A — Testo completamente opaco <span class="badge">PASS</span></h3>
          <div class="demo p12-pass equal"><div class="text">Colore pieno</div></div>
          <p class="note">Con opacità al 100% il colore rimane pieno: il contrasto è rispettato e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>12B — Testo semitrasparente <span class="badge">FAIL</span></h3>
          <div class="demo p12-fail equal"><div class="text">Colore sbiadito</div></div>
          <p class="note">La trasparenza riduce l’intensità del colore: il contrasto non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>13A — Link con contrasto sufficiente <span class="badge">PASS</span></h3>
          <div class="demo link-pass">
            Testo normale e <a href="#">link sottolineato</a> ben visibile.
          </div>
          <p class="note">Il colore del link, unito alla sottolineatura, assicura un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>13B — Link con contrasto insufficiente <span class="badge">FAIL</span></h3>
          <div class="demo link-fail">
            <span class="link-trap">Questo è un <a href="#">link</a> poco visibile.</span>
          </div>
          <p class="note">Il colore del link non è abbastanza distinto: il contrasto non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass p14-pass">
          <h3>14A — Bottone con contrasto sufficiente <span class="badge">PASS</span></h3>
          <div class="demo"><a class="btn" href="#">Scarica</a></div>
          <p class="note">Il testo del bottone rispetta le soglie di contrasto e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail p14-fail">
          <h3>14B — Bottone con contrasto insufficiente <span class="badge">FAIL</span></h3>
          <div class="demo"><a class="btn btn-trap" href="#">Scarica</a></div>
          <p class="note">Gli effetti grafici riducono la differenza tra testo e sfondo: il contrasto non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
      <div class="row">
        <article class="example pass">
          <h3>15A — Placeholder con contrasto sufficiente <span class="badge">PASS</span></h3>
          <div class="demo input-demo input-pass"><input placeholder="Cerca documenti…"></div>
          <p class="note">Il testo del placeholder ha un contrasto adeguato e garantisce un contrasto sufficiente e la leggibilità del testo.</p>
        </article>
        <article class="example fail">
          <h3>15B — Placeholder con contrasto insufficiente <span class="badge">FAIL</span></h3>
          <div class="demo input-demo input-fail"><div class="input-trap"><input placeholder="Cerca documenti…"></div></div>
          <p class="note">Il testo grigio chiaro del placeholder non raggiunge il contrasto minimo richiesto: non è sufficiente e il testo risulta poco leggibile.</p>
        </article>
      </div>
    </section>
    <footer style="margin-top:28px;font-size:.9rem;color:#111">
      <p>Questa pagina è stata creata per illustrare il Criterio di Successo 1.4.3 delle WCAG 2.1. Il Criterio riguarda la visibilità del testo e delle immagini che contengono testo. I loghi e gli elementi decorativi sono esclusi.</p>
    </footer>
  </div>
<script>
(function(){
  const c = document.getElementById('p5canvas');
  if (!c) return;
  const ctx = c.getContext('2d');
  const ratio = window.devicePixelRatio || 1;
  const W = c.width = c.clientWidth * ratio;
  const H = c.height = c.clientHeight * ratio;
  const img = new Image();
  img.src = 'my_hero.jpg'; 
  img.onload = () => {
    const iw = img.width, ih = img.height;
    const sx = Math.floor(iw * 0.55), sy = Math.floor(ih * 0.05);
    const sw = Math.floor(iw * 0.42), sh = Math.floor(ih * 0.5);
    ctx.drawImage(img, sx, sy, sw, sh, 0, 0, W, H);
    ctx.font = Math.floor(24*ratio) + 'px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial';
    ctx.fillStyle = '#8a8a8a';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('Testo dentro immagine (raster)', W/2, H/2);
  };
})();
</script>
</body>
</html>
